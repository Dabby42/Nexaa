redis:
  enabled: true
  extraLabels:
    tier: redis

replicaCount: 4

image:
  name: hera-be
  repository: acrkongaproduction.azurecr.io/hera-be:latest

nodeSelector:
  kubernetes.azure.com/agentpool: backend

minReadySeconds: 60
revisionHistoryLimit: 5

resources:
  requests:
    memory: "1024Mi"
    cpu: "1000m"

env:
  - name: NODE_PATH
    value: .
  - name: NODE_ENV
    value: production
  - name: PORT
    value: "80"
  - name: WEB_PORT
    value: "80"
  - name: APP_PORT
    value: "80"
  - name: APP_NAME
    value: hera-be
  - name: ENV
    value: production
    # Redis
  - name: REDIS_HOST
    value: "hera-be-redis.default.svc.cluster.local."
  - name: REDIS_PORT
    value: "6379"
  - name: SALT_WORK_FACTOR
    value: "10"

    # Logging
  - name: LOGGING_LEVEL
    value: debug
  - name: LOGGING_CONSOLE
    value: "true"

    # Database
  - name: DATABASE_USERNAME
    valueFrom:
      secretKeyRef:
        name: hera-be-secret
        key: database-username
  - name: DATABASE_HOST
    valueFrom:
      secretKeyRef:
        name: hera-be-secret
        key: database-host
  - name: DATABASE_PASSWORD
    valueFrom:
      secretKeyRef:
        name: hera-be-secret
        key: database-password
  - name: DATABASE_NAME
    value: hera_db
  - name: DATABASE_POOL_MAX
    value: "10"
  - name: DATABASE_POOL_MIN
    value: "2"

  #JWT
  - name: JWT_SECRET
    valueFrom:
      secretKeyRef:
        name: hera-be-secret
        key: jwt-secret
  - name: JWT_EXPIRY
    value: "1h"

  #BASEURL
  - name: BASE_URL
    value: "https://aff.konga.com"

  #SOCIAL
  - name: GOOGLE_CLIENT_ID
    valueFrom:
      secretKeyRef:
        name: hera-be-secret
        key: google-client-id
  - name: GOOGLE_CLIENT_SECRET
    valueFrom:
      secretKeyRef:
        name: hera-be-secret
        key: google-client-secret

  #HERMES
  - name: HERMES_API_URL
    value: "http://hermesapi.default.svc.cluster.local/v1/notifications"
  - name: HERMES_USE_QUEUE
    value: "true"
  - name: GENERIC_EMAIL_SENDER
    value: "affiliates@konga.com"
  - name: GENERIC_EMAIL_SENDER_ID
    value: "Konga Affiliate"
  - name: CONTACT_US_TEMPLATE_NAME
    value: "hera_contact_us"
  - name: CONTACT_US_RECIPIENT
    value: "affiliates@konga.com"
  - name: CONTACT_US_SENDER
    value: "no-reply@konga.com"
  - name: CONTACT_US_SENDER_ID
    value: "Konga Affiliate"
  - name: CONTACT_US_SUBJECT
    value: "Konga Affiliate - Contact Us"
  - name: FORGOT_PASSWORD_TEMPLATE_NAME
    value: "hera_forgot_password"
  - name: FORGOT_PASSWORD_SENDER
    value: "no-reply@konga.com"
  - name: FORGOT_PASSWORD_SENDER_ID
    value: "Konga Affiliate"
  #AMQP
  - name: AMQP_HOST
    valueFrom:
      secretKeyRef:
        name: konga-secret
        key: rabbitmq-host
  - name: AMQP_PORT
    value: "5672"
  - name: AMQP_USER
    value: "recommendation"
  - name: AMQP_PASSWORD
    valueFrom:
      secretKeyRef:
        name: konga-secret
        key: rec-amqp-password
  - name: AMQP_TIMEOUT
    value: "1000"
  - name: AMQP_HEARTBEAT
    value: "30"
  - name: AMQP_CLICKED_LINK_QUEUE
    value: "hera.clicks"
  - name: AMQP_ORDER_SYNC_QUEUE
    value: "hera.orders"
